import{n as S,q as u,l as h,s as $,v as F,x as D,y as L,d as k,z as A,o as C,k as b,w as V,u as o,T as j,A as q,B as P,e as T,C as z,D as v,E,G as Z,f as G,H,I as J,J as K,K as B,L as w,M as Q,N as I,g as U,O as W}from"../app.7dd3284e.js";const N=["success","info","warning","error"],X={id:"",message:"",type:"info",offset:16,duration:3e3,showClose:!1,zIndex:0},Y={id:{type:String,default:""},message:{type:S([String,Object,Function]),default:""},type:{type:String,values:N,default:"info"},offset:{type:Number,default:16},onClose:{type:Function,required:!1},icon:{type:S([String,Object,Function]),default:""},duration:{type:Number,default:3e3},showClose:{type:Boolean,default:!1},zIndex:{type:Number,default:0}},ee={destroy:()=>!0},se=e=>{const s={success:"success-filling",warning:"warning-filling",error:"delete-filling",info:"prompt-filling"},t=e.type;return{iconComponent:u(()=>e.icon||s[t]||"")}},te=({duration:e})=>{let s;const t=h(!1),n=()=>{e!==0&&({stop:s}=F(()=>{c()},e))},l=()=>{s==null||s()},c=()=>{t.value=!1},a=({code:r})=>{r==="Escape"&&c()};return $(()=>{n(),t.value=!0}),{visible:t,startTimer:n,clearTimer:l,keydown:a,close:c}},d=D([]),ne=e=>{const s=d.findIndex(l=>l.id===e),t=d[s];let n;return s>0&&(n=d[s-1]),{current:t,prev:n}},oe=e=>{const{prev:s}=ne(e);return s?s.vm.exposed.bottom.value:0},ae=({id:e,zIndex:s,offset:t})=>{const n=h(),l=h(0),c=u(()=>oe(e)),a=u(()=>t+c.value),r=u(()=>l.value+a.value),i=u(()=>({top:`${a.value}px`,zIndex:s}));return L(n,()=>{l.value=n.value.getBoundingClientRect().height}),{bottom:r,customStyle:i,messageRef:n}},le=e=>{const{bottom:s,customStyle:t,messageRef:n}=ae(e),{startTimer:l,clearTimer:c,keydown:a,visible:r,close:i}=te(e),{iconComponent:f}=se(e);return{messageRef:n,bottom:s,customStyle:t,visible:r,startTimer:l,clearTimer:c,close:i,iconComponent:f}},ce=["id"],re=k({name:"EtuMessage"}),ie=k({...re,props:Y,emits:ee,setup(e,{expose:s}){const t=e,n=A("message"),{messageRef:l,bottom:c,visible:a,customStyle:r,startTimer:i,clearTimer:f,close:p,iconComponent:x}=le(t),R=u(()=>[n.b(),n.m(t.type),n.is("closable",t.showClose)]),_=u(()=>[n.e("icon"),n.bm("icon",t.type)]);return s({visible:a,bottom:c,close:p}),(M,m)=>(C(),b(j,{name:o(n).b("fade"),onBeforeLeave:t.onClose,onAfterLeave:m[2]||(m[2]=g=>M.$emit("destroy"))},{default:V(()=>[q(T("div",{id:t.id,ref_key:"messageRef",ref:l,class:v(o(R)),style:J(o(r)),role:"alert",onMouseenter:m[0]||(m[0]=(...g)=>o(f)&&o(f)(...g)),onMouseleave:m[1]||(m[1]=(...g)=>o(i)&&o(i)(...g))},[o(x)?(C(),b(o(z),{key:0,name:o(x),class:v(o(_))},null,8,["name","class"])):E("",!0),Z(M.$slots,"default",{},()=>[T("p",{class:v(o(n).e("content"))},G(t.message),3)]),t.showClose?(C(),b(o(z),{key:1,name:"close-bold",class:v(o(n).e("closeBtn")),onClick:H(o(p),["stop"])},null,8,["class","onClick"])):E("",!0)],46,ce),[[P,o(a)]])]),_:3},8,["name","onBeforeLeave"]))}});let ue=1;const O=e=>{const s=!e||K(e)||B(e)||w(e)?{message:e}:e;return{...X,...s,appendTo:document.body}},de=({appendTo:e,...s})=>{const{nextZIndex:t}=Q(),n=`message_${ue++}`,l=s.onClose,c=document.createElement("div"),a={...s,zIndex:t()+s.zIndex,id:n,onClose:()=>{l==null||l(),me(p)},onDestroy:()=>{I(null,c)}},r=U(ie,a,w(a.message)||B(a.message)?{default:w(a.message)?a.message:()=>a.message}:null);I(r,c),e.appendChild(c.firstElementChild);const i=r.component,p={id:n,vnode:r,vm:i,handler:{close:()=>{i.exposed.visible.value=!1}},props:r.component.props};return p},me=e=>{const s=d.indexOf(e);if(s===-1)return;d.splice(s,1);const{handler:t}=e;t.close()},y=(e={})=>{const s=O(e),t=de(s);return d.push(t),t.handler};N.forEach(e=>{y[e]=(s={})=>{const t=O(s);return y({...t,type:e})}});function fe(e){d.forEach(s=>{(!e||e===s.props.type)&&s.handler.close()})}y.closeAll=fe;const ge=W(y,"$message");export{ge as E};
